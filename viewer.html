<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Galería | VJOX</title>
<style>
  :root{--bg:#0f0f10;--card:#16171a;--muted:#8a8f98;--text:#fff;--accent:#22c55e}
  *{box-sizing:border-box}body{margin:0;font-family:system-ui,Segoe UI,Inter,Roboto,Arial;background:var(--bg);color:var(--text)}
  header{padding:16px;border-bottom:1px solid #222}
  main{max-width:900px;margin:0 auto;padding:16px;display:grid;gap:16px}
  .title{font-size:20px;font-weight:700}
  .muted{color:var(--muted)}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}
  .card{background:var(--card);border:1px solid #26272b;border-radius:14px;padding:12px}
  .img{width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:10px;border:1px solid #2a2d33}
  .pill{display:inline-block;margin-top:8px;font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #2a2d33;background:#121316}
  .cta{display:flex;gap:10px}
  button{cursor:pointer;border:1px solid #3a3d44;background:#1a1c20;color:#fff;padding:12px 14px;border-radius:10px}
  .whats{background:#25D366;border-color:#128C7E;color:#062d1e;font-weight:700}
  footer{padding:16px;text-align:center;color:var(--muted);font-size:12px}
</style>
</head>
<body>
<header><strong>VJOX · Galería</strong></header>
<main>
  <div>
    <div class="title" id="t"></div>
    <div class="muted" id="d"></div>
  </div>
  <div class="card">
    <div id="prices" class="muted" style="margin-bottom:8px"></div>
    <div id="g" class="grid"></div>
    <div class="cta" style="margin-top:12px">
      <button class="whats" id="askBtn">Pedir por WhatsApp</button>
      <button id="copyBtn">Copiar link</button>
    </div>
  </div>
</main>
<footer>Hecho con ♥ | VJOX</footer>

<script>
function safeDecode(b64){
  try { return decodeURIComponent(escape(atob(b64))); }
  catch { return "{}"; }
}
function formatPrice(v){ 
  if(v==null || v==="") return "";
  try { return Number(v).toLocaleString("es-MX",{style:"currency",currency:"MXN"}); }
  catch { return "MXN " + Number(v).toFixed(2); }
}

(function init(){
  const hash = location.hash || "";
  const m = hash.match(/#s=([^]+)/);
  if(!m){ document.body.innerHTML = "<main style='padding:20px'><h2>Publicación no encontrada</h2></main>"; return; }

  const json = safeDecode(decodeURIComponent(m[1]));
  let data;
  try { data = JSON.parse(json); } catch { data = {}; }

  // referencias simples (ajusta a tu HTML real)
  const t = document.getElementById("t") || document.body.appendChild(Object.assign(document.createElement("h2"),{id:"t",style:"padding:16px"}));
  const d = document.getElementById("d") || document.body.appendChild(Object.assign(document.createElement("p"),{id:"d",style:"padding:0 16px"}));
  let g = document.getElementById("g");
  if(!g){ g = document.createElement("div"); g.id="g"; g.style = "display:grid;gap:10px;padding:16px;grid-template-columns:repeat(auto-fill,minmax(140px,1fr))"; document.body.appendChild(g); }

  t.textContent = data.t || "Producto";
  d.textContent = data.d || "";

  g.innerHTML = "";
  (data.u || []).forEach((url, idx)=>{
    const price = (data.pp && data.pp[idx] != null) ? data.pp[idx] : data.gp;
    const card = document.createElement("div");
    card.style = "position:relative;border:1px solid #2a2d33;border-radius:10px;overflow:hidden;background:#0b0c0e";
    card.innerHTML = `
      <img src="${url}" style="width:100%;height:140px;object-fit:cover;display:block" />
      ${price ? `<span style="position:absolute;bottom:8px;left:8px;background:rgba(0,0,0,.6);padding:4px 8px;border-radius:999px;font-size:12px;color:#fff">${formatPrice(price)}</span>` : ""}
    `;
    g.appendChild(card);
  });
})();
</script>


</body>
</html>
